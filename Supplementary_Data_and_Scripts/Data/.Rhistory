geom_boxplot(position = position_dodge(), alpha = 0.5, outlier.shape = NA)
p_GC2
fig4A <- all_data_toeholds %>%
ggplot(aes(x = target_name, y = diff_energy)) +
geom_violin(fill = 'grey') +
geom_boxplot(outlier.shape = NA, fill = 'grey', alpha = 0.5) +
geom_jitter(width = 0.15, alpha = 0.5) +
ylab('Free energy difference (kcal/mol)') + xlab('Target name')
fig4A
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(), alpha = 0.5, outlier.shape = NA)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(), alpha = 0.5, outlier.shape = NA, width = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 1.4), alpha = 0.5, outlier.shape = NA, width = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 1.2), alpha = 0.5, outlier.shape = NA, width = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 1), alpha = 0.5, outlier.shape = NA, width = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(alpha = 0.25)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(alpha = 0.25, position = position_dodge())
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(alpha = 0.25, width = 0.9)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category, colour = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(alpha = 0.25, width = 0.9)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category, colour = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(alpha = 0.25)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(alpha = 0.25, position = position_dodge(width = 0.9))
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(alpha = 0.25, dodge.width = 0.9)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(position = position_jitterdodge(), alpha = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(), alpha = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(), alpha = 0.25)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge()) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(width = 0.9), alpha = 0.25)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(width = 0.9), alpha = 1)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(), alpha = 1)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(), alpha = 1, width = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(jitter.width = 0.4), alpha = 1, width = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(jitter.width = 0.4), alpha = 1)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(jitter.width = 0.25), alpha = 1)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 1)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 1, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
geom_point(aes(colour = Category), position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 1, outlier.shape = NA, width = 0.3) +
# geom_jitter(aes(colour = Category), alpha = 0.25, dodge.width = 0.9, position = position_dodge())
# geom_point(aes(colour = Category), position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5)
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5)
p_GC2
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 0.25) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.25, outlier.shape = NA, width = 0.3)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.25) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.5, outlier.shape = NA, width = 0.3)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.75, outlier.shape = NA, width = 0.3)
p_GC2
fig4B
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.75, outlier.shape = NA, width = 0.3) +
scale_fill_manual(values = c('#ffad33', '#009900'))
p_GC2
fig4B
stat.test <- toehold_results_new_GC %>%
group_by(target_name) %>%
t_test(GC_content ~ Category)
library(ggpubr)
library(rstatix)
stat.test <- toehold_results_new_GC %>%
group_by(target_name) %>%
t_test(GC_content ~ Category)
stat.test <- toehold_results_new_GC %>%
group_by(target_name) %>%
t_test(`GC content` ~ Category)
# adjust_pvalue(method = "bonferroni") %>%
# add_significance("p.adj")
stat.test
stat.test <- stat.test %>%
add_xy_position(x = "target_name", dodge = 0.9)
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0
)
stat.test <- stat.test %>%
add_xy_position(x = "target_name", dodge = 0.9)
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.75, outlier.shape = NA, width = 0.3) +
scale_fill_manual(values = c('#ffad33', '#009900'))
p_GC2
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0
)
?add_xy_position
stat.test <- stat.test %>%
add_xy_position(x = "target_name", group = "Category", dodge = 0.9)
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.75, outlier.shape = NA, width = 0.3) +
scale_fill_manual(values = c('#ffad33', '#009900'))
p_GC2
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0
)
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category')
p_GC2
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0
)
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category') +
geom_violin()
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category') +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(), alpha = 1)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category') +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(), alpha = 0.25)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category') +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
scale_fill_manual(values = c('#ffad33', '#009900'))
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
scale_fill_manual(values = c('#ffad33', '#009900')) +
xlabs(fill = '')
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
scale_fill_manual(values = c('#ffad33', '#009900')) +
rremove(legend.title)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
rremove(legend.title)
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
# rremove(legend.title)
xlabs(fill = '', colour = '')
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
# rremove(legend.title)
labs(fill = '', colour = '')
p_GC2
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0
)
stat.test <- stat.test %>%
add_xy_position(x = "target_name", y = 90,group = "Category", dodge = 0.9)
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.75, outlier.shape = NA, width = 0.3) +
scale_fill_manual(values = c('#ffad33', '#009900'))
stat.test <- stat.test %>%
add_xy_position(x = "target_name", y = 0.9, group = "Category", dodge = 0.9)
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.2
)
stat.test <- stat.test %>%
add_xy_position(x = "target_name", group = "Category", dodge = 0.9)
p_GC2 <- toehold_results_new_GC %>%
ggplot(aes(x = target_name, y = `GC content`, fill = Category)) +
geom_violin(position = position_dodge(), alpha = 1) +
geom_point(position = position_jitterdodge(jitter.width = 0.25, dodge.width = 0.9), alpha = 0.5) +
geom_boxplot(position = position_dodge(width = 0.9), alpha = 0.75, outlier.shape = NA, width = 0.3) +
scale_fill_manual(values = c('#ffad33', '#009900'))
p_GC2
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
# rremove(legend.title)
labs(fill = '', colour = '')
p_GC2
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.2
)
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.02
)
?stat_pvalue_manual
p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.02, y.position = 90
)
table(toehold_results_new_GC$Category, toehold_results_new_GC$target_name)
p_GC_final <- p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.02, y.position = 90
)
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
# rremove(legend.title)
labs(fill = '', colour = '') +
xlab('GC content of trigger sequence(%)') + ylab('Target name')
p_GC2
p_GC_final <- p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.02, y.position = 90
)
p_GC_final
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
# rremove(legend.title)
labs(fill = '', colour = '') +
ylab('GC content of trigger sequence(%)') + xlab('Target name')
p_GC2
p_GC_final <- p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.02, y.position = 90
)
p_GC_final
ggsave(filename = file.path(main_folder, '..', 'Figures', 'Figure_GC_trigger.pdf'), plot = p_GC_final, width = 10, height = 7, device = cairo_pdf, dpi = 300)
install.packages('seqinr')
library(seqinr)
# Read the fasta files and calculate GC content
oxyR_seq <- read.fasta('/media/axelle/Angel_backup/Dropbox/Hiver2019/iGEM/Tests_oxyR/ecoli_k12_oxyR.fasta', seqtype = 'DNA')
gc_oxyR <- GC(oxyR_seq)
oxyR_seq
gc_oxyR <- GC(oxyR_seq$`lcl|NC_000913.3_cds_NP_418396.1_1`)
# phi6_CDS1
phi6_cds1_seq <- read.fasta('/media/axelle/Angel_backup/Dropbox/Hiver2019/iGEM/Viral_toeholds/Phi6_putative_CDS.fasta', seqtype = 'DNA')
gc_phi6_cds1 <- GC(phi6_cds1_seq$Phi6)
# phi6_CDS2
phi6_cds2_seq <- read.fasta('/media/axelle/Angel_backup/Dropbox/Hiver2019/iGEM/Viral_toeholds/Phi6_CDS_2.fasta', seqtype = 'DNA')
gc_pĥi6_cds2 <- gc(phi6_cds2_seq$Phi6_CDS_2)
phi6_cds2_seq
gc_pĥi6_cds2 <- GC(phi6_cds2_seq$Phi6_CDS_2)
# pr772
pr772 <- read.fasta('/media/axelle/Angel_backup/Dropbox/Hiver2019/iGEM/Viral_toeholds/PR772_ORF.fasta', seqtype = 'DNA')
# pr772
pr772_seq <- read.fasta('/media/axelle/Angel_backup/Dropbox/Hiver2019/iGEM/Viral_toeholds/PR772_ORF.fasta', seqtype = 'DNA')
gc_pr772 <- GC(pr772_seq$CDS)
# Norovirus
norovirus_seq <- read.fasta('/media/axelle/Angel_backup/iGEM/Toeholds_viruses_Nathan/norovirus_target.fasta', seqtype = 'DNA')
gc_norovirus <- GC(norovirus_seq$`lcl|NC_044045.1_cds_YP_009679035.1_2`)
# Measles virus
measles_seq <- read.fasta('/media/axelle/Angel_backup/iGEM/Toeholds_viruses_Nathan/measlesvirus_target.fasta', seqtype = 'DNA')
gc_measles <- GC(measles_seq$`lcl|MG912594.1_cds_AVA07215.1_1`)
# Herpesvirus
herpes_seq <- read.fasta('/media/axelle/Angel_backup/iGEM/Toeholds_viruses_Nathan/herpesvirus_target2.fasta', seqtype = 'DNA')
gc_herpes <- GC(herpes_seq$`ENA|BAC44882|BAC44882.1`)
fig4B
col_targets <- c('Herpesvirus', 'Measles virus', 'Norovirus', 'oxyR', 'phi6_CDS1', 'phi6_CDS2', 'pr772')
col_gc <- c(gc_herpes, gc_measles, gc_norovirus, gc_oxyR, gc_phi6_cds1, gc_phi6_cds2, gc_pr772)
col_gc <- c(gc_herpes, gc_measles, gc_norovirus, gc_oxyR, gc_phi6_cds1, gc_pĥi6_cds2, gc_pr772)
df_gc <- as.data.frame(cbind(col_targets, col_gc))
View(df_gc)
colnames(df_gc) <- c('target_name', 'GC_target')
fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = GC_target)
fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
df_gc %<>% mutate(GC_target = round(GC_target, 2))
fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
df_gc %<>% mutate(GC_target = round(as.numeric(GC_target), 2))
fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
fig4B_gc <- fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
ggsave(plot = fig4B_gc, device = cairo_pdf, width = 10, height = 7, dpi = 300,
filename = file.path(main_folder, '..', 'Figures', 'Fig4B_GC.pdf'))
p_GC2 <- toehold_results_new_GC %>%
mutate(target_name = factor(target_name, levels = c('Herpesvirus', 'Measles virus', 'Norovirus', 'oxyR', 'phi6_CDS1', 'phi6_CDS2', 'pr772'))) %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
# rremove(legend.title)
labs(fill = '', colour = '') +
ylab('GC content of trigger sequence(%)') + xlab('Target name')
p_GC2
p_GC_final <- p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.02, y.position = 90
)
p_GC_final
toehold_results_new_GC %<>%
mutate(target_name = factor(target_name, levels = c('Herpesvirus', 'Measles virus', 'Norovirus', 'oxyR', 'phi6_CDS1', 'phi6_CDS2', 'pr772')))
toehold_results_new_GC %<>%
mutate(target_name = factor(target_name, levels = c('Herpesvirus', 'Measles virus', 'Norovirus', 'oxyR', 'phi6_CDS1', 'phi6_CDS2', 'pr772')))
stat.test <- toehold_results_new_GC %>%
group_by(target_name) %>%
t_test(`GC content` ~ Category)
# adjust_pvalue(method = "bonferroni") %>%
# add_significance("p.adj")
stat.test
stat.test <- stat.test %>%
add_xy_position(x = "target_name", group = "Category", dodge = 0.9)
p_GC2 <- toehold_results_new_GC %>%
ggboxplot(x = 'target_name', y = 'GC content', color = 'Category', palette = c('#ffad33', '#009900')) +
geom_violin(aes(x = target_name, y = `GC content`, fill = Category), position = position_dodge(0.8), alpha = 0.25) +
# scale_fill_manual(values = c('#ffad33', '#009900')) +
# rremove(legend.title)
labs(fill = '', colour = '') +
ylab('GC content of trigger sequence(%)') + xlab('Target name')
p_GC2
p_GC_final <- p_GC2 + stat_pvalue_manual(
stat.test,  label = "p", tip.length = 0.02, y.position = 90
)
p_GC_final
ggsave(filename = file.path(main_folder, '..', 'Figures', 'Figure_GC_trigger.pdf'),
plot = p_GC_final, width = 10, height = 7, device = cairo_pdf, dpi = 300)
fig4B_gc <- fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
fig4B_gc
df_gc %<>% mutate(GC_target = round(as.numeric(GC_target) * 100, 2))
fig4B_gc <- fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
fig4B_gc
df_gc %<>% mutate(GC_target = round(as.numeric(GC_target) * 100, 4))
fig4B_gc <- fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
fig4B_gc
df_gc <- as.data.frame(cbind(col_targets, col_gc))
colnames(df_gc) <- c('target_name', 'GC_target')
df_gc %<>% mutate(GC_target = round(as.numeric(GC_target) * 100, 2))
df_gc <- as.data.frame(cbind(col_targets, col_gc))
colnames(df_gc) <- c('target_name', 'GC_target')
df_gc %<>% mutate(GC_target = round(as.numeric(GC_target) * 100, 2))
fig4B_gc <- fig4B + annotate(geom = 'text', x = df_gc$target_name, y = 105, label = df_gc$GC_target)
fig4B_gc
fig4B_gc
ggsave(plot = fig4B_gc, device = cairo_pdf, width = 10, height = 7, dpi = 300,
filename = file.path(main_folder, '..', 'Figures', 'Fig4B_GC.pdf'))
21*16
16 * 24
32*48
